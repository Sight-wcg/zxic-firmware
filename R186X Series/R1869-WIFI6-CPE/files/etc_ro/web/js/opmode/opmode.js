define(["knockout","service","jquery","config/config","underscore"],function(e,b,f,d,c){function a(){var h=this;h.isLoggedIn=e.observable(false);h.enableFlag=e.observable(false);h.showOpModeWindow=function(){showSettingWindow("change_mode","opmode/opmode_popup","opmode/opmode_popup",400,300,function(){})};h.currentOpMode=e.observable("0");b.getOpMode({},function(j){h.isLoggedIn(j.loginfo=="ok");if(j.opms_wan_mode=="DHCP"){h.enableFlag(true)}else{if((j.opms_wan_mode=="PPP"&&j.ppp_status!="ppp_disconnected")||(j.opms_wan_mode!="PPP"&&j.rj45_state!="idle"&&j.rj45_state!="dead")){h.enableFlag(false)}else{h.enableFlag(true)}}var k=(j.opms_wan_mode=="DHCP"||j.opms_wan_mode=="STATIC")?"PPPOE":j.opms_wan_mode;var i="";switch(k){case"BRIDGE":i="opmode_bridge";break;case"PPPOE":i="opmode_cable";break;case"PPP":i="opmode_gateway";break;default:break}f("#opmode").attr("data-trans",i).text(f.i18n.prop(i))});setInterval(function(){var i=b.getConnectionInfo();if(i.opms_wan_mode=="DHCP"){h.enableFlag(true)}else{if((i.opms_wan_mode=="PPP"&&i.ppp_status!="ppp_disconnected")||(i.opms_wan_mode!="PPP"&&i.rj45_state!="idle"&&i.rj45_state!="dead")){h.enableFlag(false)}else{h.enableFlag(true)}}},1000)}function g(){var h=f("#currentOpMode")[0];e.cleanNode(h);var i=new a();e.applyBindings(i,h)}return{init:g}});