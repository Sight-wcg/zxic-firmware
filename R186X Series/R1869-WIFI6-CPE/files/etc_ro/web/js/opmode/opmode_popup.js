define(["knockout","service","jquery","config/config","underscore"],function(d,a,f,c,b){function e(){var h=this;var i="";h.selectedMode=d.observable("0");a.getOpMode({},function(j){if(j.blc_wan_mode=="PPPOE"){i="PPPOE"}else{if(j.blc_wan_mode=="AUTO_PPP"||j.blc_wan_mode=="AUTO_PPPOE"){i="AUTO"}else{i=j.blc_wan_mode}}h.selectedMode(i)});h.changeOpMode=function(){var k=f('input:radio[name="opMode"]:checked').val();var j="";if(k==i){hidePopupSettingWindow();return}if(k=="LTE_BRIDGE"){j="opmode_msg3"}else{j="opmode_msg2"}showConfirm(j,function(){showLoading();a.SetOperationMode({opMode:k},function(m){if(m&&m.result=="success"){var l="";switch(k){case"AUTO":l="opmode_auto";break;case"PPPOE":l="opmode_cable";break;case"PPP":l="opmode_gateway";break;default:break}f("#opmode").attr("data-trans",l).text(f.i18n.prop(l));successOverlay()}else{errorOverlay()}})})}}function g(){var h=new e();d.applyBindings(h,f("#popupSettingWindow")[0]);f("#opmode_form").validate({submitHandler:function(){h.changeOpMode()}})}return{init:g}});