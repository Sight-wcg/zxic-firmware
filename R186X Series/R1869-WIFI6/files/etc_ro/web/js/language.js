define(["knockout","service","jquery","config/config","underscore"],function(i,d,b,a,f){function e(j){window.CURRENT_LANGUAGE=j;b("body").attr("lang",j);b.i18n.properties({name:"Messages",path:"i18n/",mode:"map",cache:true,language:j,callback:function(){jQuery.validator.messages=b.i18n.map;b("body").translate()}})}window.language=null;function c(){var j=this;var l=g();var k=f.map(a.LANGUAGES,function(m){return new Option(m.name,m.value)});document.title=a.WEBUI_TITLE;if(b("#webui_title")[0]){b("#webui_title").html(a.WEBUI_TITLE)}j.languages=i.observableArray(k);j.currentLan=i.observable(l.Language);window.language=j.currentLan();j.pageSwitchPC=function(){showConfirm("confirm_page_switch",function(){window.location="index.html"})};j.langChangeHandler=function(n,m){clearValidateMsg();d.setLanguage({Language:j.currentLan()},function(){e(j.currentLan());window.language=j.currentLan();var q=location.href;var o=q.split("#");var p=o[o.length-1];if(p=="station_info"){location.reload()}})};e(j.currentLan())}function g(){return d.getLanguage()}function h(){i.applyBindings(new c(),b("#language")[0])}return{init:h}});